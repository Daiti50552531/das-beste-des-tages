<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>das-beste-des-tages</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React & ReactDOM CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- Lucide Icons CDN -->
  <script type="module" src="https://cdn.jsdelivr.net/npm/lucide-react@0.287.0/dist/esm/index.js"></script>
  <!-- Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/javascript">
    const { useState, useRef, useEffect } = React;
    const { Search, Download, Plus, Edit2, Trash2, X, Calendar, Upload } = lucideReact;

    // Supabase Verbindung
    const supabaseUrl = https://htbxjnoxpzviuiiwbciv.supabase.co;
    const supabaseKey = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh0Ynhqbm94cHp2aXVpaXdiY2l2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0OTc4MzIsImV4cCI6MjA3ODA3MzgzMn0.D5kFuUTHfVg92m1zzDNj9-PXaQzivm9uO1hNZyk6PAE;
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    function DiaryApp() {
      const [entries, setEntries] = useState([]);
      const [showForm, setShowForm] = useState(false);
      const [editingEntry, setEditingEntry] = useState(null);
      const [searchTerm, setSearchTerm] = useState('');
      const [showSettings, setShowSettings] = useState(false);
      const [darkMode, setDarkMode] = useState(false);
      const fileInputRef = useRef(null);
      
      const [fieldLabels, setFieldLabels] = useState({
        field1: 'Was ist passiert?',
        field2: 'Was habe ich gelernt?',
        field3: 'WofÃ¼r bin ich dankbar?'
      });
      
      const [formData, setFormData] = useState({
        date: new Date().toISOString().split('T')[0],
        text1: '',
        text2: '',
        text3: '',
        mood: null
      });

      // Funktion: Neues Entry hinzufÃ¼gen oder bearbeiten
      const handleSubmit = async (e) => {
        e.preventDefault();
        if (!formData.mood) { alert('Bitte wÃ¤hle eine Stimmung aus'); return; }

        try {
          if (editingEntry) {
            await supabase.from('entries').update(formData).eq('id', editingEntry.id);
          } else {
            await supabase.from('entries').insert([formData]);
          }
          loadEntries();
          resetForm();
          setShowForm(false);
          setEditingEntry(null);
        } catch (error) {
          console.error(error);
          alert('Fehler beim Speichern');
        }
      };

      const resetForm = () => {
        setFormData({ date: new Date().toISOString().split('T')[0], text1:'', text2:'', text3:'', mood:null });
      };

      const loadEntries = async () => {
        const { data, error } = await supabase.from('entries').select('*').order('date', { ascending: false });
        if (!error) setEntries(data);
      };

      useEffect(() => { loadEntries(); }, []);

      const getMoodEmoji = (mood) => {
        return mood === 1 ? 'ðŸ˜ž' : mood === 2 ? 'ðŸ˜' : mood === 3 ? 'ðŸ™‚' : '';
      };

      return (
        React.createElement('div', { className: `min-h-screen ${darkMode ? 'bg-gray-900' : 'bg-gray-50'}` },
          React.createElement('div', { className: `${darkMode ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-200'} border-b sticky top-0 z-10` },
            React.createElement('div', { className: 'max-w-2xl mx-auto px-4 py-4 flex items-center justify-between' },
              React.createElement('h1', { className: `text-2xl font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}` }, 'das-beste-des-tages'),
              React.createElement('div', { className: 'flex items-center gap-3' },
                React.createElement('button', { onClick: () => setDarkMode(!darkMode), className: `p-2 rounded-lg transition-colors ${darkMode ? 'bg-gray-700 text-yellow-400 hover:bg-gray-600' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}` },
                  darkMode ? 'ðŸŒ™' : 'â˜€ï¸'
                )
              )
            )
          ),
          React.createElement('div', { className: 'max-w-2xl mx-auto px-4 py-6' }, 
            entries.map(entry =>
              React.createElement('div', { key: entry.id, className: `${darkMode ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-200'} rounded-2xl shadow-sm border p-5 mb-4` },
                React.createElement('div', null,
                  React.createElement('div', null, entry.date),
                  React.createElement('div', null, getMoodEmoji(entry.mood)),
                  React.createElement('div', null, entry.text1),
                  React.createElement('div', null, entry.text2),
                  React.createElement('div', null, entry.text3)
                )
              )
            )
          )
        )
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(DiaryApp));
  </script>
</body>
</html>
