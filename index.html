<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Das Beste des Tages</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

    const supabaseUrl = https://github.com/Daiti50552531/das-beste-des-tages.git;
    const supabaseKey = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh0Ynhqbm94cHp2aXVpaXdiY2l2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0OTc4MzIsImV4cCI6MjA3ODA3MzgzMn0.D5kFuUTHfVg92m1zzDNj9-PXaQzivm9uO1hNZyk6PAE;
    const supabase = createClient(supabaseUrl, supabaseKey);

    async function saveEntry() {
      const date = new Date().toISOString().split("T")[0];
      const text1 = document.getElementById("text1").value.trim();
      const text2 = document.getElementById("text2").value.trim();
      const text3 = document.getElementById("text3").value.trim();
      const mood = document.querySelector("input[name='mood']:checked")?.value;

      if (!mood) {
        alert("Bitte Stimmung ausw√§hlen");
        return;
      }

      await supabase.from("entries").insert({ date, text1, text2, text3, mood });
      await loadEntries();

      document.getElementById("text1").value = "";
      document.getElementById("text2").value = "";
      document.getElementById("text3").value = "";
      document.querySelector("input[name='mood']:checked").checked = false;
    }

    async function loadEntries() {
      const { data, error } = await supabase
        .from("entries")
        .select("*")
        .order("date", { ascending: false });

      const list = document.getElementById("list");
      list.innerHTML = "";

      if (error) {
        list.innerHTML = "<p class='text-red-500'>Fehler beim Laden der Eintr√§ge.</p>";
        return;
      }

      data.forEach(item => {
        const div = document.createElement("div");
        div.className = "bg-white p-3 rounded shadow mb-2";
        const moodSymbol = item.mood == 3 ? "üòä" : item.mood == 2 ? "üòê" : "üòû";
        div.innerHTML = `
          <div class="text-sm text-gray-500">${item.date}</div>
          <div>Stimmung: ${moodSymbol}</div>
          <ul class="list-disc ml-4">
            <li>${item.text1 || ""}</li>
            <li>${item.text2 || ""}</li>
            <li>${item.text3 || ""}</li>
          </ul>
        `;
        list.appendChild(div);
      });
    }

    window.onload = loadEntries;
  </script>
</head>
<body class="bg-gray-100 p-4">
  <h1 class="text-2xl font-bold mb-4 text-center">Das Beste des Tages</h1>

  <div class="max-w-md mx-auto bg-white p-4 rounded shadow">
    <textarea id="text1" class="w-full p-2 border rounded mb-2" placeholder="Moment 1"></textarea>
    <textarea id="text2" class="w-full p-2 border rounded mb-2" placeholder="Moment 2"></textarea>
    <textarea id="text3" class="w-full p-2 border rounded mb-2" placeholder="Moment 3"></textarea>

    <div class="flex justify-around my-3">
      <label class="text-2xl"><input type="radio" name="mood" value="1"> üòû</label>
      <label class="text-2xl"><input type="radio" name="mood" value="2"> üòê</label>
      <label class="text-2xl"><input type="radio" name="mood" value="3"> üòä</label>
    </div>

    <button onclick="saveEntry()" class="w-full bg-blue-600 text-white p-2 rounded">
      Speichern
    </button>
  </div>

  <h2 class="text-xl font-semibold my-4 text-center">Bisherige Eintr√§ge</h2>
  <div id="list" class="max-w-md mx-auto"></div>
</body>
</html>
